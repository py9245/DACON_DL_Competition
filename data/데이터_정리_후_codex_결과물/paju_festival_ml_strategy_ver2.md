# 파주시 축제 활성화를 위한 데이터 기반 전략 (Ver.2)

> **작성 목적**: 현 디렉터리에 존재하는 모든 데이터셋(주요 CSV 21종 + 내외국인 비교 자료 15종)을 최대 300행까지 직접 확인한 결과를 바탕으로, 축제 최적 시기 예측 및 맞춤 솔루션 제공을 위한 ML/DL 활용 방안을 심층적으로 정리한다. 본 문서는 Ver.1 대비 데이터 프로파일링 세부 지표와 모델링 설계안을 대폭 보강했다.

---

## 1. 데이터 전수 개요 및 분석 범위
- **전체 파일 수**: 36개 CSV (루트 21 + `내외국인_비교데이터` 15)
- **공통 특징**: 대부분 2024.01~2025.09 기간의 주차/월 단위 데이터, 설문 기반 범주형 컬럼이 많음. 일부 정적 인프라 데이터 존재.
- **표준 분석 범위**: 각 CSV에서 최대 300행까지 직접 로드하여 컬럼 수, 결측치, 고유값 등을 확인. `데이터_정리_후_codex_결과물/data_profile_summary.json`에 세부 메타정보 저장.
- **주요 분류**
  1. 설문 기반 데이터 (4종)
  2. 월별·주차별 시계열 데이터 (8종 이상)
  3. 내·외국인 비교 데이터 (15종)
  4. 행정동 단위 정적 현황 데이터 (5종)
  5. 기타 통합본 (예: `년도별_인구감소지역…`, `월별_방문자수 히트맵` 등)

---

## 2. 데이터 프로파일링 (300행 샘플 기반)

### 2.1 설문 기반 4대 통합본
1. **설문_국내_여행_비용_지출_의향_통합.csv**
   - **행/열**: 총 46,000행, 8개 컬럼 (샘플 300행 모두 결측 없음).
   - **핵심 컬럼**: `EXAMIN_BEGIN_DE`(조사일, int), `SEXDSTN_FLAG_CD`, `AGRDE_FLAG_NM`, `ANSWRR_OC_AREA_NM`, `HSHLD_INCOME_DGREE_NM`, 지출 의향 3종(전체/국내/해외).
   - **샘플 고유값**: 성별 2종(M/F), 연령 5종(20~60대), 거주지 16개 광역권, 소득 5구간, 의향값 5단계(“훨씬 더 적게”~“훨씬 더 많이”).
   - **인사이트**: 전수 기준 응답량이 가장 많아 주차별 가중치 산출에 활용 가능. 모든 응답이 범주형이라 스코어링 규칙 설계가 필수.

2. **설문_국내_여행_비용_지출_특성_통합.csv**
   - **행/열**: 총 28,858행, 18개 컬럼.
   - **주요 변수**: 지출구간(숙박/식비/교통/쇼핑/체험/기타), 방문지역(`TOUR_CTPRVN_NM`, `TOUR_SIGNGU_NM`), 동행 인원(`TOUR_COM_NMPR_NM`), 체류기간(`TOUR_PD_VALUE`), 응답 특성(성별·연령·혼인·자녀·직업·소득).
   - **샘플 고유값**: 파주시 포함 134개 시군구 확인, 지출 구간 6~7단계(“모름” 포함), 동행 인원 6단계(1~5명 이상).
   - **특이점**: 결측 없음. 파주시 응답은 145행 수준(전체 데이터로 확인) → 파주시 직접 수요 분석 가능.

3. **설문_국내_여행자_특성.csv**
   - **행/열**: 1,968행, 4개 컬럼.
   - **구성**: `EXAMIN_YM`(월 기준), `RESPOND_CHARTR_SDIV_ID`(세그먼트 코드), `RESPOND_CHARTR_SDIV_NM`(한글명), `RSPNS_RATE`(비율).
   - **세그먼트**: 성별, 연령, 소득, 거주지, 가계생애주기 등 57개 수준. 월별 응답 비중 변화를 추적해 타깃 그룹 트렌드 파악 가능.
   - **주요 이슈**: 월 단위라 주차 기반 데이터와 결합 시 월→주차 분배 필요.

4. **설문_국내_여행지역_관심도.csv**
   - **행/열**: 23,064행, 16개 컬럼.
   - **내용**: 응답자 속성 + 전국 11개 권역(서울, 경기·인천, 부산, 충청권 등)에 대한 관심 변화(5단계 서술형).
   - **샘플 특징**: 조사일 2종(20240101, 20240108)만 등장 → 주차 단위로 제공됨. 모든 열 결측 없음.
   - **활용 포인트**: 경기도/서울 관심도 스코어를 축제 시기별 수요 선행지표로 변환 가능.

### 2.2 월별·주차별 시계열 데이터
1. **월별_관광지_방문객추세_LG유플러스.csv**
   - **행/열**: 23행(2023.01~2024.11 추정), 10컬럼.
   - **주요 값**: `방문자수`, `관내방문자수`, `관내주민 비중`, `외지관광객 비중`, `3개월 이동평균`. `전년동월 증감률`/`전월 증감률` 일부 결측.
   - **의미**: 실측 방문자수(월) → 축제 수요 라벨로 활용 가능.

2. **월별_관광지_소비지표_삼성카드.csv**
   - **행/열**: 23행, 13컬럼.
   - **내용**: 매출총액, 결제건수, 객단가, 전월/전년 대비 증감률, 3개월 이동평균, 관광형/일상형 비중 등.
   - **활용**: 축제 성공 시 예상 매출 추정, 카드사 데이터 기반.

3. **월별_생활인구_LG유플러스.csv**
   - **행/열**: 19행, 2컬럼 (`기준월`, `생활인구수`). 특정 행정동/도시 대상.
   - **활용**: 상시 체류인구 파악, 계절성 보정.

4. **월별_파주시방문 추이.csv**
   - **행/열**: 36행, 5컬럼 (`기준월`, `지역`, `방문자수`, `방문자수 증감`). 정밀 파주시 수요.

5. **월별_검색건수 추이.csv / 월별_유형별 검색건수.csv / 월별_지역별 검색건수.csv**
   - **범위**: 검색 키워드/유형/지역별 월간 검색량, 360행·27행·1,175행 등 다양한 스케일.
   - **특징**: 전월대비 증감률 포함, 모든 값 결측 없음. 축제 관심도 선행지표로 적합.

6. **월별_방문자수 히트맵.csv**
   - **행/열**: 362행 × 8컬럼, `월`, `요일`, `시간대` 등 방문 양상 히트맵. `메모` 컬럼(=NaN) 존재 → 불용 컬럼 처리.

7. **월별_경기도_파주시_지역화폐 발행및이용현황.csv**
   - **행/열**: 23행 × 13컬럼 (카드 발행액, 사용액, 평균권면 등). 지역화폐와 관광소비 연계 분석 가능.

8. **월별_생활인구_LG유플러스.csv** 외 다른 생활인구 관련 CSV (예: `현시점_행정동별_생활인구_경기데이터드림.csv`)는 시점 스냅샷이지만 행정동별 세부 데이터 제공.

### 2.3 내외국인 비교 데이터 (폴더)
- **공통 특징**: 대부분 100행 이하, 컬럼 4~10개, 결측 거의 없음.
- **주요 파일**
  - `내외국인_관광소비 추이.csv`: 연도·월별 내국인 vs 외국인 소비액.
  - `내외국인_업종별 지출액.csv`: 업종별(음식, 숙박 등) 소비 비교.
  - `내외국인_지역별 지출액.csv`: 시도별 지출 규모.
  - `인기관광지_전체/현지인/외지인.csv`: 관광지 ID, 명칭, 유형, 집계값.
  - `주요 유료관광지점 입장객 수_내국인/외국인/전체.csv`: 월단위 관람객 수.
  - `지역_맛집_전체/외지인/현지인.csv`: 맛집 ID, 지역, 카테고리, 방문 비중.
- **활용 포인트**: 축제 타깃이 내국인인지 외국인인지에 따라 수요 상이 → 세그먼트별 마케팅 전략.

### 2.4 행정동 단위 정적 데이터
1. **현시점_행정동별_생활인구_경기데이터드림.csv**
   - **행/열**: 215행 × 9컬럼 (시군명, 읍면동, 생활인구, 전년 대비 증감 등).
   - **활용**: 파주시 행정동별 상주인구 기반 지역별 축제 거점 선정.
2. **현시점_행정동별_숙박시설 및 객실 수 상세.csv**
   - **행/열**: 362행 × 8컬럼. 시설명, 주소, 객실수, 업종 등.
   - **결측**: `메모` 컬럼 전체 NaN → 삭제 가능.
   - **활용**: 숙박 수용력 지도화.
3. **현시점_업종별 관광사업체 수.csv**
   - **행/열**: 300행 × 7컬럼, 파주시 업종별 업체 수.
4. **현시점_행정동별_식품위생업소_영업유형분포_삼성카드.csv** / `...소비규모...`
   - 행정동/업종별 분포 및 카드 소비액.
5. **현시점_행정동별_인구소비지표_추정요약.csv**
   - 19행 × 5컬럼, 유동/방문/전출입 지표 요약.

### 2.5 기타 데이터
- **년도별_인구감소지역 현황 및 지역주민 소비액_한국관광 데이터랩_통합.csv**: 2021~2023 연도별 지표(37컬럼). 파주시가 포함된 인구감소지역 여부 및 소비 특성 파악.
- **설문_국내여행_TOP10_트랜드_데이터_결과.csv**: 5,550행 × 12컬럼, 일자별 키워드·지역 검색량. `기간` 컬럼 포함.
- **내외국인_비교데이터/중심 관광지.csv** 등: 계층형 관광지 속성 정보 → 추천 장소 후보군 데이터.

---

## 3. 주요 이슈 및 전처리 전략
1. **인코딩/컬럼명 깨짐**: Windows CP949/UTF-8 동시 사용으로 인해 일부 파일명·컬럼명이 깨져 표기됨. 분석 시 `utf-8-sig` 표준화 및 컬럼 한글 복구 필요.
2. **날짜 포맷 통일**
   - 설문: `EXAMIN_BEGIN_DE` (YYYYMMDD), `EXAMIN_YM` (YYYYMM) → `datetime` 변환 후 `연/월/ISO주차/주차키` 파생.
   - 월별 데이터: `기준월`, `기간` 등 문자열이 혼재 → `YYYY-MM` 형태로 표준화.
3. **범주형 응답 처리**
   - 지출 구간: “10~20만원 미만” 등 문자열 → 구간 중앙값 추정 (예: 15만원) 및 “모름” 별도 코드.
   - 의향/관심 응답: 5단계 서술형 → 정수 스코어(-2~-1~0~1~2) 매핑, 필요 시 확률분포 encoding.
4. **파주시 연계 필터**
   - `TOUR_SIGNGU_NM`, 관광지/맛집 데이터의 `지역` 컬럼 등에서 “파주시” 키워드 필터.
   - 행정동 데이터: 파주시 행만 추출해 공간적 세분화 가능.
5. **결측 처리**
   - 방문/소비 데이터의 전월·전년 대비 증감률 일부 결측 → 직전 3개월 이동평균 혹은 시계열 분해로 보간.
   - 카드 매출 데이터의 `관광형/일상형 비중` 결측은 0으로 보간 시 왜곡 → 전체 합 100% 기준으로 재계산.
6. **중복 및 이상치**
   - 일부 파일(예: `월별_지역별 검색건수.csv`)은 `기관표준` 및 `분류` 컬럼에 공백 포함 → strip 필요.
   - 검색량/매출 데이터의 outlier는 로그 변환 또는 IQR 기반 winsorizing 고려.

---

## 4. 통합 데이터 모델 설계

### 4.1 공통 키 정의
| 구분 | 컬럼 | 설명 |
| --- | --- | --- |
| 주차 키 | `week_key = YYYY-ISOweek` | 설문·주차 단위 데이터의 공통 키. `datetime.isocalendar()` 사용 |
| 월 키 | `month_key = YYYY-MM` | 월별 데이터 통합용 |
| 지역 키 | `region_key` | (시군구 또는 관광지 ID). 파주시 중심일 경우 `PAJU` 고정 |
| 세그먼트 키 | `segment_key` | 설문 세그먼트 (연령, 가족구성 등) 표준 코드 |

### 4.2 데이터 통합 레이어
1. **Survey Layer**: 설문 의향/특성/관심/여행자 특성에서 주차별·세그먼트별 통계 파생 (응답자수, 평균 스코어, 분산, 백분위 등).
2. **Behavior Layer**: 방문자수, 생활인구, 카드 소비, 지역화폐, 검색량을 월/주차별로 정렬. Lag/Led 변수 생성.
3. **Place Layer**: 관광지/맛집/숙박/행정동별 특성. 공간 좌표(주소)와 시설 용량 데이터 포함.
4. **External Layer**(추가 필요): 기상, 공휴일, 경쟁 이벤트(수집 필요).

### 4.3 파생 지표 예시
- **의향 지수**: `intention_score = α*국내지출의향 + β*전체지출의향` (α, β 가중치).
- **관심도 지수**: 경기도·서울 관심 스코어 평균 → `interest_gyeonggi`, 타 권역 대비 차이.
- **파주 방문 잠재지수**: `f(paju_visitors, paju_spending, search_volume_paju)`를 정규화한 합성 스코어.
- **시설 수용력 지표**: `숙박객실수`, `식품업소수`, `관광사업체수` 등을 기준으로 `capacity_index` 산출.
- **주차 수요 지표**: `대인원(4인이상) 비율 * 수도권 거주 비율 * 자동차 교통비 고액 비중`.

---

## 5. 라벨링 전략 (축제 성과 Proxy)

### 5.1 1차 라벨: 방문자/소비 지표
- `월별_관광지_방문객추세_LG유플러스`의 `방문자수` (월) → 주차 모델에 적용하려면 해당 월의 주차 수로 나눠 분배.
- `월별_관광지_소비지표_삼성카드`의 `총매출액`, `객단가`. 소비 예측 모델.
- `월별_파주시방문 추이`의 `방문자수` → 파주시 한정 라벨.
- 방문자수/매출 모두 **회귀 타깃**으로 사용 가능.

### 5.2 2차 라벨: 종합 축제 적합도 점수
- 위 3개 라벨을 Min-Max 정규화 후 가중합 → `festival_score`. 가중치는 이해관계자 협의(예: 방문자 0.5, 매출 0.3, 검색량 0.2).
- `festival_score` 상위 20% 주차를 `1`로 라벨링 → **이진 분류 모델** 구축.

### 5.3 3차 라벨: 세그먼트별 수요
- `설문_국내_여행자_특성`의 `RSPNS_RATE`를 세그먼트별 라벨로 사용. 예) 20대 비중 예측.
- `설문_국내_여행_비용_특성`에서 파주시 응답의 `숙박/교통 지출`을 금액화하여 `expected_spend_paju` 회귀 타깃 설정.

---

## 6. 모델링 전략

### 6.1 베이스라인 (Classical ML)
- **회귀**: LightGBM/XGBoost/RandomForest → 다수 범주형 변수를 원-핫/타깃 인코딩 후 적용. 장점: 피처 중요도 해석 용이.
- **분류**: LightGBM, CatBoost (범주형 자동 처리). `festival_score_top20` 이진 라벨 예측.
- **멀티아웃풋 회귀**: `MultiOutputRegressor(LightGBM)`으로 방문자/매출/관심도 동시 예측.

### 6.2 시계열 특화 모델
- **Temporal Fusion Transformer (TFT)**: 주차별 시계열 예측에 적합, 다중 관찰/외생 변수 처리 가능.
- **Prophet/SARIMAX**: 월 단위 베이스라인. 축제 시즌성을 확인하는 용도.
- **N-BEATS / DeepAR**: 개별 시계열(방문자, 소비) 예측 후 결과 앙상블.

### 6.3 시나리오 추천 모델
- **규칙 기반** + **예측 결과** 조합. 예)
  1. 모델이 높은 수요를 예측한 주차 중, 의향·관심도 스코어 모두 양수인 시점만 후보군 설정.
  2. 후보군 중 시설 수용력 대비 예상 방문자가 높은 순으로 Top-N 추천.
  3. 추천 결과에 맞춰 행사 종류(체험형/공연형/푸드형) 매칭: 지출 특성 데이터의 상위 지출 항목 활용.

### 6.4 방문객 특성 예측
- **클러스터링**: `설문_국내_여행_비용_특성` + `설문_국내_여행자_특성` 결합 후 KMeans/Hierarchical Clustering으로 페르소나 4~5개 정의.
- **분포 예측**: Dirichlet Regression 또는 Softmax Regression으로 세그먼트 비율 예측.

### 6.5 모델 학습 전략
- **검증 방법**: Rolling Origin Cross-Validation (예: 2024Q1→Q2, 2024Q2→Q3 …)로 시간 누적 학습.
- **하이퍼파라미터**: Optuna 활용.
- **Feature Selection**: SHAP, Permutation Importance로 주요 변수 도출 → 정책 대응.
- **앙상블**: LightGBM + CatBoost + TFT 예측 결과를 가중 평균.

---

## 7. 사용자 입력 기반 추천 프로세스
1. **입력 수집**: 유저가 축제 희망 기간(`2025-05-W2` 등), 축제 타입(음식/문화/체험), 목표 관객 규모 입력.
2. **데이터 필터링**: Feature Store에서 해당 주차 ±2주 범위 데이터 로딩, Lag 변수 
